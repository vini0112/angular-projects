"use strict";(self.webpackChunkclothes_store=self.webpackChunkclothes_store||[]).push([[420],{5420:(J,g,a)=>{a.r(g),a.d(g,{CheckoutPaymentComponent:()=>Y});var l,f=a(467),e=a(3953),h="https://js.stripe.com",R="".concat(h,"/v3"),w=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,j=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,v="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",T=function(n){return w.test(n)||j.test(n)},y=function(n){var t=n&&!n.advancedFraudSignals?"?advancedFraudSignals=false":"",o=document.createElement("script");o.src="".concat(R).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(o),o},c=null,m=null,u=null,S=!1,E=function(){return l||(l=(n=null,null!==c?c:(c=new Promise(function(t,o){if(typeof window>"u"||typeof document>"u")t(null);else if(window.Stripe&&n&&console.warn(v),window.Stripe)t(window.Stripe);else try{var i=function(){for(var n=document.querySelectorAll('script[src^="'.concat(h,'"]')),t=0;t<n.length;t++){var o=n[t];if(T(o.src))return o}return null}();if(i&&n)console.warn(v);else if(i){if(i&&null!==u&&null!==m){var s;i.removeEventListener("load",u),i.removeEventListener("error",m),null===(s=i.parentNode)||void 0===s||s.removeChild(i),i=y(n)}}else i=y(n);u=function(n,t){return function(){window.Stripe?n(window.Stripe):t(new Error("Stripe.js not available"))}}(t,o),m=function(n){return function(t){n(new Error("Failed to load Stripe.js",{cause:t}))}}(o),i.addEventListener("load",u),i.addEventListener("error",m)}catch(p){return void o(p)}})).catch(function(t){return c=null,Promise.reject(t)})).catch(function(n){return l=null,Promise.reject(n)}));var n};Promise.resolve().then(function(){return E()}).catch(function(r){S||console.warn(r)});var A=a(4034),D=a(9305),$=a(177),d=a(4341),U=a(3587),B=a(1453),V=a(9615);function X(r,n){if(1&r&&(e.j41(0,"div",7)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&r){const t=e.XpG();e.R7$(2),e.SpI("SubTotal (",t.paymentElements.quantity," items)"),e.R7$(2),e.SpI("$",t.paymentElements.amount,"")}}function _(r,n){if(1&r&&(e.j41(0,"div",8)(1,"span"),e.EFF(2,"Total Amount"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&r){const t=e.XpG();e.R7$(4),e.SpI("$",t.paymentElements.amount,"")}}function W(r,n){if(1&r&&(e.j41(0,"button",9),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.Y8G("disabled",t.loading),e.R7$(),e.SpI(" ",t.loading?"Loading...":"Buy"," ")}}function N(r,n){if(1&r&&(e.j41(0,"div",10),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.JRh(t.paymentElements.message)}}let Y=(()=>{class r{checkoutService=(0,e.WQX)(D.C);messageService=(0,e.WQX)(B.b);authServiceLogin=(0,e.WQX)(V.x);userPurchaseData;stripe=null;elements=null;loading=!1;paymentElements;ngOnInit(){var t=this;return(0,f.A)(function*(){t.loadUserPurchaseData(),yield t.buildingStripeFormElements()})()}loadUserPurchaseData(){this.userPurchaseData=this.checkoutService.getUserPurchaseData(),this.paymentElements=this.assigningStripFormVariables()}assigningStripFormVariables(){return{clientSecret:this.userPurchaseData?.clientSecret||"",amount:this.userPurchaseData?.amount||0,quantity:this.userPurchaseData?.quantity||0,message:""}}buildingStripeFormElements(){var t=this;return(0,f.A)(function*(){t.stripe=yield function(){for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];S=!0;var i=Date.now();return E().then(function(s){return function(n,t,o){if(null===n)return null;var s=t[0].match(/^pk_test/),p=function(n){return 3===n?"v3":n}(n.version);s&&"v3"!==p&&console.warn("Stripe.js@".concat(p," was loaded on the page, but @stripe/stripe-js@").concat("5.10.0"," expected Stripe.js@").concat("v3",". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var x=n.apply(void 0,t);return function(n,t){!n||!n._registerWrapper||n._registerWrapper({name:"stripe-js",version:"5.10.0",startTime:t})}(x,o),x}(s,t,i)})}(U.c.stripe_public_key,{locale:"en"}),t.stripe&&t.paymentElements.clientSecret?(t.elements=t.stripe.elements({clientSecret:t.paymentElements.clientSecret}),t.elements.create("payment").mount("#payment-element")):t.paymentElements.message="Error: Payment not initialized!"})()}submitOfPurchaseConclusion(){var t=this;return(0,f.A)(function*(){if(!t.stripe||!t.paymentElements.clientSecret||!t.elements)return;const{error:o}=yield t.stripe.confirmPayment({elements:t.elements,confirmParams:{return_url:"http://localhost:4200/payment-status"}});o&&(console.error("Payment Error:",o.message),t.messageService.showMessage("Payment failed!","error"))})()}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=e.VBU({type:r,selectors:[["app-checkout-payment"]],decls:7,vars:4,consts:[[3,"submit"],["id","payment-element"],["class","subTotalBox",4,"ngIf"],["class","totalAmount",4,"ngIf"],[1,"boxBtn"],["type","submit",3,"disabled",4,"ngIf"],["class","messageERROR",4,"ngIf"],[1,"subTotalBox"],[1,"totalAmount"],["type","submit",3,"disabled"],[1,"messageERROR"]],template:function(o,i){1&o&&(e.j41(0,"form",0),e.bIt("submit",function(){return i.submitOfPurchaseConclusion()}),e.nrm(1,"div",1),e.DNE(2,X,5,2,"div",2)(3,_,5,1,"div",3),e.j41(4,"div",4),e.DNE(5,W,2,2,"button",5),e.k0s(),e.DNE(6,N,2,1,"div",6),e.k0s()),2&o&&(e.R7$(2),e.Y8G("ngIf",!i.paymentElements.message),e.R7$(),e.Y8G("ngIf",!i.paymentElements.message),e.R7$(2),e.Y8G("ngIf",!i.paymentElements.message),e.R7$(),e.Y8G("ngIf",i.paymentElements.message))},dependencies:[A.Rn,$.bT,d.YN,d.qT,d.cb,d.cV],styles:["[_nghost-%COMP%]{height:80vh;display:flex;justify-content:center;align-items:center;padding:10px}.messageERROR[_ngcontent-%COMP%]{text-align:center;color:red;font-size:.9rem;font-weight:600}form[_ngcontent-%COMP%]{max-width:500px;width:100%;background-color:#fff;border-radius:20px;padding:20px}.boxBtn[_ngcontent-%COMP%]{display:flex;justify-content:center}button[_ngcontent-%COMP%]{margin-top:.3rem;border:none;background-color:#00f;color:#fff;font-weight:600;width:280px;height:50px;font-size:1.3rem;letter-spacing:1px;border-radius:5px;text-shadow:1px 1px 1px black}.subTotalBox[_ngcontent-%COMP%]{border-radius:5px;background-image:linear-gradient(to right,#dcdcdc,#fff);height:100%;display:flex;justify-content:space-between;align-items:center;height:50px;margin-top:1rem;margin-bottom:.3rem}.subTotalBox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child, .totalAmount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{margin-right:5px;color:#000;text-shadow:none}.subTotalBox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child, .totalAmount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{margin-left:5px;font-weight:600;color:#fff;text-shadow:1px 1px 2px black}.totalAmount[_ngcontent-%COMP%]{border-radius:5px;background-image:linear-gradient(to right,#dcdcdc,#fff);height:100%;display:flex;justify-content:space-between;align-items:center;height:35px;margin-bottom:1rem}@media screen and (max-width:380px){[_nghost-%COMP%]{height:100vh}}"],changeDetection:0})}return r})()}}]);